<!DOCTYPE html>
<html lang="en">
  <meta
    http-equiv="content-type"
    content="text/html;charset=utf-8"
  />

  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>CHAAND</title>

    <!-- Bootstrap core CSS -->
    <link href="./lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
  </head>

  <body>
    <section class="MAP">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-9">
            <div id="map-canvas"></div>
          </div>
          <div class="col-md-3">
            <div class="accordion" id="accordionExample">
              <div class="card z-depth-0 bordered">
                <div class="card-header" id="headingOne">
                  <h5 class="mb-0">
                    <button
                      class="btn btn-link"
                      type="button"
                      data-toggle="collapse"
                      data-target="#collapseOne"
                      aria-expanded="true"
                      aria-controls="collapseOne"
                    >
                      Country 1
                    </button>
                  </h5>
                </div>
                <div
                  id="collapseOne"
                  class="collapse show"
                  aria-labelledby="headingOne"
                  data-parent="#accordionExample"
                >
                  <div class="">
                    <div class="list-group">
                      <button
                        type="button"
                        data-office="1"
                        class="list-group-item list-group-item-action"
                      >
                        City 1
                      </button>
                      <button
                        type="button"
                        data-office="2"
                        class="list-group-item list-group-item-action"
                      >
                        City 2
                      </button>
                      <button
                        type="button"
                        data-office="3"
                        class="list-group-item list-group-item-action"
                      >
                        City 3
                      </button>
                      <button
                        type="button"
                        data-office="4"
                        class="list-group-item list-group-item-action"
                      >
                        City 4
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card z-depth-0 bordered">
                <div class="card-header" id="headingTwo">
                  <h5 class="mb-0">
                    <button
                      class="btn btn-link collapsed"
                      type="button"
                      data-toggle="collapse"
                      data-target="#collapseTwo"
                      aria-expanded="false"
                      aria-controls="collapseTwo"
                    >
                      Country 2
                    </button>
                  </h5>
                </div>
                <div
                  id="collapseTwo"
                  class="collapse"
                  aria-labelledby="headingTwo"
                  data-parent="#accordionExample"
                >
                  <div class="">
                    <div class="list-group">
                      <button
                        type="button"
                        data-office="1"
                        class="list-group-item list-group-item-action"
                      >
                        City 1
                      </button>
                      <button
                        type="button"
                        data-office="2"
                        class="list-group-item list-group-item-action"
                      >
                        City 2
                      </button>
                      <button
                        type="button"
                        data-office="3"
                        class="list-group-item list-group-item-action"
                      >
                        City 3
                      </button>
                      <button
                        type="button"
                        data-office="4"
                        class="list-group-item list-group-item-action"
                      >
                        City 4
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card z-depth-0 bordered">
                <div class="card-header" id="headingThree">
                  <h5 class="mb-0">
                    <button
                      class="btn btn-link collapsed"
                      type="button"
                      data-toggle="collapse"
                      data-target="#collapseThree"
                      aria-expanded="false"
                      aria-controls="collapseThree"
                    >
                      Country #3
                    </button>
                  </h5>
                </div>
                <div
                  id="collapseThree"
                  class="collapse"
                  aria-labelledby="headingThree"
                  data-parent="#accordionExample"
                >
                  <div class="">
                    <div class="list-group">
                      <button
                        type="button"
                        data-office="1"
                        class="list-group-item list-group-item-action"
                      >
                        City 1
                      </button>
                      <button
                        type="button"
                        data-office="2"
                        class="list-group-item list-group-item-action"
                      >
                        City 2
                      </button>
                      <button
                        type="button"
                        data-office="3"
                        class="list-group-item list-group-item-action"
                      >
                        City 3
                      </button>
                      <button
                        type="button"
                        data-office="4"
                        class="list-group-item list-group-item-action"
                      >
                        City 4
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script src="./lib/jquery/jquery.min.js"></script>
    <script src="./lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js"></script>

    <style>
      #map-canvas {
        height: 100%;
        min-height: 450px;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>

    <script>
      $(document).ready(function() {
        var map;

        var locations = [
          {
            id: 1,
            title: "Midtown",
            images: [
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150"
            ],
            point: { lat: 17.4628926, lng: 78.4884239 }
          },
          {
            id: 2,
            title: "Uptown",
            images: [
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150"
            ],
            point: { lat: 17.1628965, lng: 77.9747768 }
          },
          {
            id: 3,
            title: "Center",
            images: [
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150"
            ],
            point: { lat: -34.387, lng: 150.641 }
          },
          {
            id: 4,
            title: "Center",
            images: [
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150",
              "https://via.placeholder.com/250x150"
            ],
            point: { lat: -33.387, lng: 130.641 }
          }
        ];

        $("[data-office]").click(function(sender) {
          var data =
            parseInt(sender.currentTarget.attributes["data-office"].value) - 1;
          var marker = locations[data].marker;

          // close others
          for (var i = 0; i < locations.length; i++) {
            if (i == data) continue;
            var _marker = locations[i].marker;
            _marker.info.close(map, _marker);
          }

          marker.info.open(map, marker);
        });

        function initMap() {
          map = new google.maps.Map(document.getElementById("map-canvas"), {
            center: locations[0].point,
            zoom: 2
          });

          for (var i = 0; i < locations.length; i++) {
            var marker = new google.maps.Marker({
              map: map,
              position: locations[i].point,
              clickable: true
            });

            var office = locations[i];
            marker.info = new google.maps.InfoWindow({
              content: getInfoWindow(office)
            });

            google.maps.event.addListener(marker, 'click', (function(marker, i) {
                return function() {
                    marker.info.open(map, marker);
                }
            })(marker, i));


            office.marker = marker;
          }
        }

        initMap();

        function getInfoWindow(office) {
          var counter = 0;
          return (
            '<div class="card" style="width: 10rem;">' +
            '<div id="office-carousel-' +
            office.id +
            '" class="carousel slide" data-ride="carousel">' +
            '<div class="carousel-inner">' +
            office.images
              .map(img => {
                var _class = "";
                if (counter++ == 0) _class = "active";
                return (
                  '<div class="carousel-item ' + _class + '"><img src="' +img + '" class="d-block w-100" alt="..."></div>'
                );
              })
              .join("") +
            "</div>" +
            '<a class="carousel-control-prev" href="#office-carousel-' +
            office.id +
            '" role="button" data-slide="prev">' +
            '<span class="carousel-control-prev-icon" aria-hidden="true"></span>' +
            '<span class="sr-only">Previous</span>' +
            "</a>" +
            '<a class="carousel-control-next" href="#office-carousel-' +
            office.id +
            '" role="button" data-slide="next">' +
            '<span class="carousel-control-next-icon" aria-hidden="true"></span>' +
            '<span class="sr-only">Next</span>' +
            "</a>" +
            "</div>" +
            '<div class="card-body"><h5 class="card-title">Card title</h5><p class="card-text">This is a wider card   longer.</p><p class="card-text"><small class="text-muted"><span>seen 200k</span> |  <span>liked 120k</span></small></p></div>'+
            "</div>"
          );
        }
      });
    </script>
  </body>
</html>
